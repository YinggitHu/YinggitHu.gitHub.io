module.exports=ClientAuthenticationPacket;function ClientAuthenticationPacket(a){a=a||{};this.clientFlags=a.clientFlags;this.maxPacketSize=a.maxPacketSize;this.charsetNumber=a.charsetNumber;this.filler=undefined;this.user=a.user;this.scrambleBuff=a.scrambleBuff;this.database=a.database;this.protocol41=a.protocol41}ClientAuthenticationPacket.prototype.parse=function(a){if(this.protocol41){this.clientFlags=a.parseUnsignedNumber(4);this.maxPacketSize=a.parseUnsignedNumber(4);this.charsetNumber=a.parseUnsignedNumber(1);this.filler=a.parseFiller(23);this.user=a.parseNullTerminatedString();this.scrambleBuff=a.parseLengthCodedBuffer();this.database=a.parseNullTerminatedString()}else{this.clientFlags=a.parseUnsignedNumber(2);this.maxPacketSize=a.parseUnsignedNumber(3);this.user=a.parseNullTerminatedString();this.scrambleBuff=a.parseBuffer(8);this.database=a.parseLengthCodedBuffer()}};ClientAuthenticationPacket.prototype.write=function(a){if(this.protocol41){a.writeUnsignedNumber(4,this.clientFlags);a.writeUnsignedNumber(4,this.maxPacketSize);a.writeUnsignedNumber(1,this.charsetNumber);a.writeFiller(23);a.writeNullTerminatedString(this.user);a.writeLengthCodedBuffer(this.scrambleBuff);a.writeNullTerminatedString(this.database)}else{a.writeUnsignedNumber(2,this.clientFlags);a.writeUnsignedNumber(3,this.maxPacketSize);a.writeNullTerminatedString(this.user);a.writeBuffer(this.scrambleBuff);if(this.database&&this.database.length){a.writeFiller(1);a.writeBuffer(new Buffer(this.database))}}};
var Types=require("../constants/types");var Charsets=require("../constants/charsets");var Field=require("./Field");var IEEE_754_BINARY_64_PRECISION=Math.pow(2,53);module.exports=RowDataPacket;function RowDataPacket(){}Object.defineProperty(RowDataPacket.prototype,"parse",{configurable:true,enumerable:false,value:parse});Object.defineProperty(RowDataPacket.prototype,"_typeCast",{configurable:true,enumerable:false,value:typeCast});function parse(a,c,j,d,b){var k=this;var g=function(){return k._typeCast(e,a,b.config.timezone,b.config.supportBigNumbers,b.config.bigNumberStrings,b.config.dateStrings)};for(var f=0;f<c.length;f++){var e=c[f];var h;if(typeof j==="function"){h=j.apply(b,[new Field({packet:e,parser:a}),g])}else{h=(j)?this._typeCast(e,a,b.config.timezone,b.config.supportBigNumbers,b.config.bigNumberStrings,b.config.dateStrings):((e.charsetNr===Charsets.BINARY)?a.parseLengthCodedBuffer():a.parseLengthCodedString())}if(typeof d==="string"&&d.length){this[e.table+d+e.name]=h}else{if(d){this[e.table]=this[e.table]||{};this[e.table][e.name]=h}else{this[e.name]=h}}}}function typeCast(f,b,j,i,h,c){var e;switch(f.type){case Types.TIMESTAMP:case Types.TIMESTAMP2:case Types.DATE:case Types.DATETIME:case Types.DATETIME2:case Types.NEWDATE:var g=b.parseLengthCodedString();if(typeMatch(f.type,c)){return g}if(g===null){return null}var a=g;if(f.type===Types.DATE){g+=" 00:00:00"}if(j!=="local"){g+=" "+j}var d=new Date(g);if(isNaN(d.getTime())){return a}return d;case Types.TINY:case Types.SHORT:case Types.LONG:case Types.INT24:case Types.YEAR:case Types.FLOAT:case Types.DOUBLE:e=b.parseLengthCodedString();return(e===null||(f.zeroFill&&e[0]==="0"))?e:Number(e);case Types.NEWDECIMAL:case Types.LONGLONG:e=b.parseLengthCodedString();return(e===null||(f.zeroFill&&e[0]==="0"))?e:((i&&(h||(Number(e)>=IEEE_754_BINARY_64_PRECISION)||Number(e)<=-IEEE_754_BINARY_64_PRECISION))?e:Number(e));case Types.BIT:return b.parseLengthCodedBuffer();case Types.STRING:case Types.VAR_STRING:case Types.TINY_BLOB:case Types.MEDIUM_BLOB:case Types.LONG_BLOB:case Types.BLOB:return(f.charsetNr===Charsets.BINARY)?b.parseLengthCodedBuffer():b.parseLengthCodedString();case Types.GEOMETRY:return b.parseGeometryValue();default:return b.parseLengthCodedString()}}function typeMatch(b,c){if(Array.isArray(c)){for(var a=0;a<c.length;a++){if(Types[c[a]]===b){return true}}return false}else{return Boolean(c)}};